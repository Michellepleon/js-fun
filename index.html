<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Grumpy Life</title>
    <link
      rel="icon"
      href="http://orig14.deviantart.net/7b01/f/2013/196/6/8/grumpy_cat_by_lord_iluvatar-d6dj8g3.png"
    />
  </head>
  <body></body>
  <script>
    //--------------------------------------------------------------------------
    // CREATION OF ELEMENTS IN THE DOM
    //--------------------------------------------------------------------------
    const mainTitle = document.createElement("h1");
    const paragraphIntroduction = document.createElement("p");
    const grumpyCatWithHat = document.createElement("img");
    const breakLine1 = document.createElement("br");
    const breakLine2 = document.createElement("br");
    const buttonCreateForm = document.createElement("button");
    const sectionForm = document.createElement("section");
    const form = document.createElement("form");
    const formLabel = document.createElement("label");
    const textCatName = document.createElement("p");
    const inputBoxCatName = document.createElement("input");
    const textPersonName = document.createElement("p");
    const inputBoxPersonName = document.createElement("input");
    const textCatAge = document.createElement("p");
    const inputCatAge = document.createElement("input");
    // const checkBox = document.createElement("input");
    const buttonSub = document.createElement("button");
    const headerTextForm = document.createElement("h2");

    // creation of elements
    document.body.appendChild(mainTitle);
    document.body.appendChild(paragraphIntroduction);
    document.body.appendChild(grumpyCatWithHat);
    document.body.appendChild(breakLine1);
    document.body.appendChild(buttonCreateForm);
    document.body.appendChild(headerTextForm);
    document.body.appendChild(sectionForm);
    //--------------------------------------------------------------------------
    // ADDING CONTENT IN ATTRIBUTS & INNER HTML
    //--------------------------------------------------------------------------
    // Adding content between open and closing tags
    mainTitle.innerHTML = "Grumpy Life";
    paragraphIntroduction.innerHTML =
      "Let's get <b>grumpy</b> with us! Bring <b>grumpyness</b> in your family and make your life worth living!";
    buttonCreateForm.innerHTML = "Subscribe!";
    textCatName.innerHTML = "What is your cat's name?";
    textPersonName.innerHTML = "What is your name?";
    textCatAge.innerHTML = "How old is your cat";
    // path to images
    grumpyCatWithHat.src =
      "https://i.kinja-img.com/gawker-media/image/upload/t_original/e0vnqjuayk153fmusl5x.jpg";
    //--------------------------------------------------------------------------
    // ADDING STYLE (CSS) TO ELEMENT
    //--------------------------------------------------------------------------
    grumpyCatWithHat.style.width = "480px";
    grumpyCatWithHat.style.height = "320px";
    grumpyCatWithHat.style.borderRadius = "20px";
    buttonCreateForm.style.backgroundColor = "cyan";
    //--------------------------------------------------------------------------
    // FUNCTIONS DECLARATIONS
    //--------------------------------------------------------------------------
    function createInputForm() {
      // add child to form
      sectionForm.appendChild(form);
      form.appendChild(formLabel);
      form.appendChild(textCatName);
      form.appendChild(inputBoxCatName);
      form.appendChild(textPersonName);
      form.appendChild(inputBoxPersonName);
      form.appendChild(textCatAge);
      form.appendChild(inputCatAge);
      form.appendChild(breakLine2);
      form.appendChild(buttonSub);
      // set attributes values
      form.id = "myForm";
      form.method = "post";
      form.action = "";
      form.style.width = "300px";
      form.style.margin = "0px";
      inputBoxCatName.type = "text";
      inputBoxCatName.placeholder = "Cat Name";
      inputBoxCatName.style = "";
      inputBoxCatName.id = "catName";
      inputBoxCatName.className = "inputToValid";
      inputBoxPersonName.type = "text";
      inputBoxPersonName.placeholder = "Name";
      inputBoxPersonName.style = "";
      inputBoxPersonName.id = "parentName";
      inputBoxPersonName.className = "inputToValid";
      inputCatAge.type = "text";
      inputCatAge.placeholder = "Age";
      inputCatAge.style = "";
      inputCatAge.id = "ageCat";
      inputCatAge.className = "inputToValid";
      buttonSub.id = "buttonSub";
      buttonSub.type = "button";
      buttonSub.value = "Submit";
      buttonSub.style.backgroundColor = "pink";
      buttonSub.innerHTML = "Submit";
      headerTextForm.innerHTML =
        "Tell us about your cat, how grumpy is it? üêà‚Äç";
    }

    function getInputs() {
      const inputNodes = document.getElementsByTagName("input");
      let inputsValue = { catName: "", personName: "", catAge: "" };
      for (let i = 0; i < inputNodes.length; i++) {
        if (inputNodes[i].type.toLowerCase() == "text") {
          console.log(inputNodes[i].value);
          if (i == 0) {
            inputsValue.catName = inputNodes[i].value;
          } else if (i == 1) {
            inputsValue.personName = inputNodes[i].value;
          } else if (i == 2) {
            inputsValue.catAge = inputNodes[i].value;
          }
        }
      }
      console.log(inputsValue);
      return inputsValue;
    }

    function isValidFormlength(inputsValueObject) {
      let valid = false;
      if (
        inputsValueObject.catName.length >= 2 &&
        inputsValueObject.catName.length <= 15 &&
        inputsValueObject.personName.length >= 2 &&
        inputsValueObject.personName.length <= 15 &&
        inputsValueObject.catAge.length >= 1 &&
        inputsValueObject.catAge.length <= 2
      ) {
        console.log("The inputs length is valid!");
        valid = true;
      } else {
        console.log("The inputs length is invalid!");
      }
      return valid;
    }

    function isValidCapitalLetter(input) {
      const maximumCapitalLetters = 5;
      let capitalLetterFound = "";
      let numberOfCapitalLetters = 0;
      let isFound = false;
      for (let i = 0; i < input.length; i++) {
        if (
          input.charAt(i) == input.charAt(i).toUpperCase() &&
          input.charAt(i).match(/[a-z]/i)
        ) {
          capitalLetterFound = input.charAt(i);
          console.log("Capital letter found is: " + capitalLetterFound);
          numberOfCapitalLetters++;
        }
      }
      if (
        numberOfCapitalLetters > 0 &&
        numberOfCapitalLetters <= maximumCapitalLetters
      ) {
        console.log(
          "There's " + numberOfCapitalLetters + " capital letters found!"
        );
        console.log(
          "The name has at most one capital letter and maximum " +
            maximumCapitalLetters +
            "!"
        );
        isFound = true;
      } else {
        console.log(
          "There's " + numberOfCapitalLetters + " capital letters found!"
        );
        console.log(
          "The name needs to have at most one capital letter and maximum " +
            maximumCapitalLetters +
            "!"
        );
      }
      return isFound;
    }

    function sendData(data) {
      fetch("/", {
        method: "POST",
        headers: {
          Accept: "application/json, text/plain, */*",
          "Content-Type": "application/json",
        },
        body: JSON.stringify(data),
      })
        .then((res) => res.json())
        .then((res) => console.log(res));
    }

    function isValidInputs(inputsValueObject) {
      let isValid = false;
      if (
        isValidFormlength(inputsValueObject) &&
        isValidCapitalLetter(inputsValueObject.catName) &&
        isValidCapitalLetter(inputsValueObject.personName)
      ) {
        isValid = true;
      }
      return isValid;
    }
    //--------------------------------------------------------------------------
    // EVENT LISTENERS
    //--------------------------------------------------------------------------
    buttonCreateForm.addEventListener("click", () => {
      createInputForm();
    });

    buttonSub.addEventListener("click", () => {
      let inputsValueObject = getInputs();
      if (isValidInputs(inputsValueObject)) {
        console.log("My inputs as object is:", inputsValueObject);
        sendData(inputsValueObject);
      } else {
        console.log("wrong inputs");
      }
    });
  </script>
</html>
